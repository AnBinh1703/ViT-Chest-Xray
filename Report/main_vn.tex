%!TEX program = xelatex
% ============================================================================
% NHÓM 1 - BÁO CÁO ĐỒ ÁN CUỐI KỲ DEEP LEARNING
% So sánh CNN, ResNet và Vision Transformers cho phân loại đa nhãn bệnh 
% từ ảnh X-quang ngực
% ============================================================================
\documentclass[11pt,a4paper]{article}

% ============================================================================
% PACKAGES
% ============================================================================
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\geometry{margin=2.5cm}
\usepackage{graphicx}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{float}
\usepackage{subcaption}
\usepackage{caption}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{titlesec}

% ============================================================================
% COLORS & STYLING
% ============================================================================
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\definecolor{urlblue}{RGB}{0,0,139}

\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,
    urlcolor=urlblue,
    citecolor=blue,
}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2
}
\lstset{style=mystyle}

% ============================================================================
% HEADER & FOOTER
% ============================================================================
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small Deep Learning - Nhóm 1}
\fancyhead[R]{\small Phân loại bệnh từ X-quang ngực}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}

% ============================================================================
% TITLE
% ============================================================================
\title{
    \vspace{-1cm}
    \textbf{So sánh CNN, ResNet và Vision Transformers\\
    cho Phân loại Đa nhãn Bệnh từ Ảnh X-quang Ngực}\\[0.5cm]
    \large Đồ án cuối kỳ môn Deep Learning - Nhóm 1\\
    Trường Kinh doanh - Thạc sĩ Kinh tế
}

\author{
    \textbf{Thành viên Nhóm 1}\\[0.3cm]
    \begin{tabular}{c}
        % Điền tên thành viên
    \end{tabular}
}

\date{\today}

% ============================================================================
% DOCUMENT
% ============================================================================
\begin{document}

\maketitle

% ============================================================================
% TÓM TẮT
% ============================================================================
\begin{abstract}
Báo cáo này trình bày nghiên cứu so sánh ba kiến trúc deep learning chính cho bài toán phân loại đa nhãn bệnh phổi từ ảnh X-quang ngực: Convolutional Neural Networks (CNN), Residual Networks (ResNet-34), và Vision Transformers (ViT). Chúng tôi thực hiện các mô hình từ đầu bằng PyTorch và so sánh với mô hình ViT tiền huấn luyện từ thư viện \texttt{timm}. Kết quả cho thấy: (1) ViT pretrained đạt AUC cao nhất (0.67), (2) các mô hình huấn luyện từ đầu với dữ liệu nhỏ cho hiệu suất thấp hơn, (3) transfer learning là cần thiết cho ứng dụng y khoa, (4) AUC là metric quan trọng hơn accuracy do class imbalance nghiêm trọng. Bộ dữ liệu sử dụng là NIH Chest X-ray 14 với 112,120 ảnh và 15 lớp bệnh.

\vspace{0.3cm}
\noindent\textbf{Từ khóa:} Vision Transformer, X-quang ngực, Phân loại đa nhãn, Deep Learning, Hình ảnh y khoa, Transfer Learning
\end{abstract}

% ============================================================================
% MỤC LỤC
% ============================================================================
\tableofcontents
\newpage

% ============================================================================
% PHẦN 1: CÁC MÔ HÌNH DEEP LEARNING
% ============================================================================
\part{Các Mô Hình Deep Learning}

% Bao gồm các file mô hình
\input{chapters/models/cnn}
\input{chapters/models/resnet}
\input{chapters/models/vit_scratch}
\input{chapters/models/vit_pretrained}

% ============================================================================
% PHẦN 2: TỔNG KẾT VÀ KHUYẾN NGHỊ
% ============================================================================
\part{Tổng Kết và Khuyến Nghị}

\section{Tổng kết kết quả}
\label{sec:summary}

Qua quá trình thực nghiệm với 5 mô hình khác nhau trên bộ dữ liệu NIH Chest X-ray 14, chúng tôi rút ra các kết luận sau:

\begin{enumerate}
    \item \textbf{Transfer learning là cần thiết}: Mô hình ViT pretrained cho kết quả tốt nhất (AUC = 0.67), cao hơn đáng kể so với các mô hình huấn luyện từ đầu.
    
    \item \textbf{Kiến trúc đơn giản có thể hiệu quả với dữ liệu nhỏ}: CNN baseline (95M params) đạt AUC tương đương ViT scratch (9M params) trên tập dữ liệu sample nhỏ.
    
    \item \textbf{AUC là metric quan trọng hơn accuracy}: Accuracy cao (89-91\%) không phản ánh chính xác khả năng phân loại bệnh do class imbalance nghiêm trọng.
    
    \item \textbf{Các bệnh hiếm cần được chú ý đặc biệt}: Mass, Hernia, Pneumonia có prevalence $< 2\%$ và AUC thường thấp hơn 0.5.
\end{enumerate}

\section{Khuyến nghị cải tiến}
\label{sec:recommendations}

\subsection{Về kiến trúc mô hình}
\begin{itemize}[noitemsep]
    \item Sử dụng Global Average Pooling thay vì Flatten trong CNN
    \item Áp dụng pretrained ResNet hoặc EfficientNet cho so sánh công bằng hơn
    \item Thử nghiệm ViT-Small hoặc DeiT để cân bằng giữa hiệu suất và chi phí tính toán
\end{itemize}

\subsection{Về huấn luyện}
\begin{itemize}[noitemsep]
    \item Sử dụng Focal Loss hoặc Weighted BCE để xử lý class imbalance
    \item Áp dụng Cosine Annealing LR scheduler
    \item Tăng số epoch và sử dụng early stopping với patience lớn hơn
    \item Huấn luyện trên toàn bộ dataset (112,120 ảnh) thay vì sample
\end{itemize}

\subsection{Về dữ liệu}
\begin{itemize}[noitemsep]
    \item Sử dụng patient-level split để tránh data leakage
    \item Giảm horizontal flip probability (0.3 thay vì 0.5) do đặc thù ảnh y khoa
    \item Áp dụng thêm augmentation: MixUp, CutMix, AutoAugment
\end{itemize}

\subsection{Về đánh giá}
\begin{itemize}[noitemsep]
    \item Báo cáo per-class AUC cho tất cả 15 bệnh
    \item Sử dụng bootstrap để tính confidence interval
    \item Thực hiện cross-validation để đánh giá robustness
\end{itemize}

% ============================================================================
% TÀI LIỆU THAM KHẢO
% ============================================================================
\section*{Tài liệu tham khảo}
\addcontentsline{toc}{section}{Tài liệu tham khảo}

\begin{thebibliography}{10}

\bibitem{jain2024comparative}
Jain, A., Bhardwaj, A., Murali, K., \& Surani, I. (2024).
\textit{A Comparative Study of CNN, ResNet, and Vision Transformers for Multi-Classification of Chest Diseases}.
arXiv preprint arXiv:2406.00237.

\bibitem{wang2017chestx}
Wang, X., Peng, Y., Lu, L., Lu, Z., Bagheri, M., \& Summers, R. M. (2017).
\textit{ChestX-ray8: Hospital-scale chest x-ray database and benchmarks}.
IEEE CVPR.

\bibitem{dosovitskiy2020image}
Dosovitskiy, A., et al. (2020).
\textit{An image is worth 16x16 words: Transformers for image recognition at scale}.
ICLR 2021.

\bibitem{he2016deep}
He, K., Zhang, X., Ren, S., \& Sun, J. (2016).
\textit{Deep residual learning for image recognition}.
IEEE CVPR.

\bibitem{vaswani2017attention}
Vaswani, A., et al. (2017).
\textit{Attention is all you need}.
NeurIPS 2017.

\end{thebibliography}

\end{document}
